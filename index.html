<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Geschiedenis Toetstrainer â€“ Tijdvak 1 & 2</title>
  <style>
    :root { --bg1:#f8fafc; --bg2:#eef2ff; --ink:#0f172a; --muted:#64748b; --brand:#2563eb; --brand2:#4f46e5; --ok:#10b981; --bad:#ef4444; font-family:'Inter',system-ui,Segoe UI,Roboto,Arial,sans-serif; }
    *{box-sizing:border-box}
    body{margin:0;background:linear-gradient(135deg,var(--bg1),var(--bg2));color:var(--ink)}
    .wrap{max-width:1100px;margin:auto;padding:20px}
    h1{font-size:2.2rem;font-weight:900;margin:.2rem 0 .3rem}
    h2{font-size:1.6rem;margin-top:0}
    .muted{color:var(--muted)}
    .pill{display:inline-flex;align-items:center;gap:.3rem;border:1px solid #e2e8f0;background:#fff;border-radius:999px;padding:.25rem .6rem;font-size:.8rem;margin-right:.3rem}
    nav.tabs{display:grid;grid-template-columns:repeat(auto-fit,minmax(130px,1fr));gap:8px;margin:10px 0 16px}
    .btn{border:2px solid #e5e7eb;background:#fff;color:var(--ink);padding:10px;border-radius:12px;font-weight:700;cursor:pointer;transition:.15s}
    .btn:hover{transform:translateY(-1px)}
    .btn.primary{background:var(--brand);border-color:var(--brand);color:#fff}
    .hidden{display:none}
    .card{background:#fff;border-radius:16px;box-shadow:0 4px 20px rgba(0,0,0,.06);padding:18px;margin-top:1rem}
    .grid{display:grid;gap:14px}
    @media(min-width:800px){.g2{grid-template-columns:1fr 1fr}}
    .flashQ{font-weight:700;font-size:1.15rem;border:1px solid #e5e7eb;border-radius:14px;padding:14px;text-align:center}
    .answer{margin-top:8px;border:1px solid #e5e7eb;background:#f8fafc;border-radius:12px;padding:12px;display:none}
    .feedback.good{background:#ecfdf5;border:1px solid #a7f3d0;padding:1rem;border-radius:12px}
    .feedback.bad{background:#fef2f2;border:1px solid #fecaca;padding:1rem;border-radius:12px}
    /* Progress bars */
    .progress{height:10px;border-radius:999px;background:#e5e7eb;overflow:hidden}
    .progress>i{display:block;height:100%;background:linear-gradient(90deg,var(--ok),#34d399);width:0}
    .progress-total{height:14px}
    .stars{letter-spacing:1px}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Geschiedenis Toetstrainer â€” Tijdvak 1 & 2</h1>
      <p class="muted">Leer alles over <b>Jagers & Boeren</b> en <b>Grieken & Romeinen</b>. Je mag altijd door naar het volgende onderdeel.</p>
      <div style="display:flex;gap:6px;flex-wrap:wrap;margin-bottom:8px">
        <span class="pill">â±ï¸ 1â€‘uurs plan</span>
        <span class="pill">ğŸ§  Actief herinneren</span>
        <span class="pill">ğŸ Eindtoets</span>
      </div>
      <!-- TOTAL PROGRESS BAR -->
      <div class="card" style="margin:0">
        <div style="display:flex;justify-content:space-between;align-items:center;gap:12px">
          <div>
            <div class="muted" style="font-weight:700">Totale voortgang</div>
            <div class="progress progress-total"><i id="totalBar"></i></div>
            <div class="muted" style="margin-top:6px"><span id="totalPct">0%</span> Â· Voltooide onderdelen: <span id="stepsDone">0</span>/6</div>
          </div>
          <div style="display:flex;gap:8px;align-items:center">
            <div class="muted">â­ï¸ <span id="overallStars" class="stars">â˜†â˜†â˜†</span></div>
            <button class="btn" id="resetProgress">Reset voortgang</button>
          </div>
        </div>
      </div>
    </header>

    <nav class="tabs">
      <button class="btn primary" data-tab="overview">ğŸ“š Overzicht</button>
      <button class="btn" data-tab="t1">ğŸŒ¾ Tijdvak 1</button>
      <button class="btn" data-tab="quiz1">ğŸ§ª Deeltoets T1</button>
      <button class="btn" data-tab="t2">ğŸ›ï¸ Tijdvak 2</button>
      <button class="btn" data-tab="quiz2">ğŸ§ª Deeltoets T2</button>
      <button class="btn" data-tab="final">ğŸ Eindtoets</button>
    </nav>

    <!-- OVERVIEW -->
    <section class="card" id="tab-overview">
      <h2>ğŸ“š Overzicht Tijdvakken</h2>
      <ul>
        <li><b>Tijdvak 1:</b> Jagers en boeren â€” tot 3000 v.Chr. (landbouw, dorpen, steden)</li>
        <li><b>Tijdvak 2:</b> Grieken en Romeinen â€” 3000 v.Chr. â€“ 500 n.Chr. (wetenschap, democratie, Romeins rijk)</li>
      </ul>
      <div class="muted" style="margin-top:8px">Lees deze hardop. Klaar? Ga door naar Tijdvak 1.</div>
    </section>

    <!-- T1 -->
    <section class="card hidden" id="tab-t1">
      <h2>ğŸŒ¾ Tijdvak 1 â€“ Jagers en boeren</h2>
      <ul>
        <li>Nomadisch bestaan (rondtrekkend)</li>
        <li>Landbouwrevolutie â†’ vaste woonplaatsen (sedentair)</li>
        <li>Specialisatie, handel, sociale gelaagdheid</li>
        <li>Ontstaan steden en schrift (einde prehistorie)</li>
      </ul>
      <div class="flashQ" id="fc1-q">Nomadisch</div>
      <div class="answer" id="fc1-a">Rondtrekkend leven; geen vaste woonplaats.</div>
      <div style="display:flex;gap:8px;margin:8px 0"><button class="btn" id="fc1-show">Toon antwoord</button><button class="btn" id="fc1-next">Volgende kaart</button></div>
      <div class="muted" id="fc1-count">1 / 5</div>
      <div style="margin-top:8px">
        <div class="muted">Voortgang flashcards</div>
        <div class="progress"><i id="t1Bar"></i></div>
        <div class="muted">â­ï¸ <span id="t1Stars" class="stars">â˜†â˜†â˜†</span></div>
      </div>
    </section>

    <!-- QUIZ 1 -->
    <section class="card hidden" id="tab-quiz1">
      <h2>ğŸ§ª Deeltoets Tijdvak 1</h2>
      <div id="q1"></div>
      <div style="display:flex;gap:8px;margin-top:10px"><button class="btn primary" id="q1-check">Check</button><button class="btn" id="q1-next">Volgende vraag</button></div>
      <div id="q1-feedback" class="feedback hidden" style="margin-top:10px"></div>
      <div class="muted" id="q1-progress" style="margin-top:6px">Vraag 1 / 6 Â· Goed: 0</div>
      <div style="margin-top:8px">
        <div class="muted">Voortgang deeltoets T1 (goede antwoorden)</div>
        <div class="progress"><i id="q1Bar"></i></div>
        <div class="muted">â­ï¸ <span id="q1Stars" class="stars">â˜†â˜†â˜†</span></div>
      </div>
    </section>

    <!-- T2 -->
    <section class="card hidden" id="tab-t2">
      <h2>ğŸ›ï¸ Tijdvak 2 â€“ Grieken en Romeinen</h2>
      <ul>
        <li>Grieken: polis, democratie, filosofie (Socrates, Plato, Aristoteles)</li>
        <li>Romeinen: imperium, romanisering, Pax Romana</li>
        <li>Kunst: klassieke vormentaal (zuilen), Romeinen: bogen/koepels</li>
        <li>Religie: polytheÃ¯sme â†’ monotheÃ¯sme</li>
      </ul>
      <div class="flashQ" id="fc2-q">Polis</div>
      <div class="answer" id="fc2-a">Griekse stadstaat met eigen bestuur en wetten.</div>
      <div style="display:flex;gap:8px;margin:8px 0"><button class="btn" id="fc2-show">Toon antwoord</button><button class="btn" id="fc2-next">Volgende kaart</button></div>
      <div class="muted" id="fc2-count">1 / 7</div>
      <div style="margin-top:8px">
        <div class="muted">Voortgang flashcards</div>
        <div class="progress"><i id="t2Bar"></i></div>
        <div class="muted">â­ï¸ <span id="t2Stars" class="stars">â˜†â˜†â˜†</span></div>
      </div>
    </section>

    <!-- QUIZ 2 -->
    <section class="card hidden" id="tab-quiz2">
      <h2>ğŸ§ª Deeltoets Tijdvak 2</h2>
      <div id="q2"></div>
      <div style="display:flex;gap:8px;margin-top:10px"><button class="btn primary" id="q2-check">Check</button><button class="btn" id="q2-next">Volgende vraag</button></div>
      <div id="q2-feedback" class="feedback hidden" style="margin-top:10px"></div>
      <div class="muted" id="q2-progress" style="margin-top:6px">Vraag 1 / 8 Â· Goed: 0</div>
      <div style="margin-top:8px">
        <div class="muted">Voortgang deeltoets T2 (goede antwoorden)</div>
        <div class="progress"><i id="q2Bar"></i></div>
        <div class="muted">â­ï¸ <span id="q2Stars" class="stars">â˜†â˜†â˜†</span></div>
      </div>
    </section>

    <!-- FINAL -->
    <section class="card hidden" id="tab-final">
      <h2>ğŸ Eindtoets</h2>
      <div id="qfinal"></div>
      <div style="display:flex;gap:8px;margin-top:10px"><button class="btn primary" id="qfinal-check">Check</button><button class="btn" id="qfinal-next">Volgende vraag</button></div>
      <div id="qfinal-feedback" class="feedback hidden" style="margin-top:10px"></div>
      <div class="muted" id="qfinal-progress" style="margin-top:6px">Vraag 1 / 10 Â· Goed: 0</div>
      <div style="margin-top:8px">
        <div class="muted">Voortgang eindtoets (goede antwoorden)</div>
        <div class="progress"><i id="finalBar"></i></div>
        <div class="muted">â­ï¸ <span id="finalStars" class="stars">â˜†â˜†â˜†</span></div>
      </div>
    </section>
  </div>

<script>
// ---------- Local Storage helpers ----------
const KEY='geschiedenis_trainer_progress_v1';
function load(){ try{return JSON.parse(localStorage.getItem(KEY))||{};}catch(e){return {}} }
function save(data){ localStorage.setItem(KEY, JSON.stringify(data)); }
let state=load();
if(!state.sections){ state={sections:{t1:{done:false,fcDone:0,fcTotal:5}, q1:{correct:0,total:6,attempted:0}, t2:{done:false,fcDone:0,fcTotal:7}, q2:{correct:0,total:8,attempted:0}, final:{correct:0,total:10,attempted:0}}, stepsCompleted:0}; }
save(state);

// ---------- Tabs ----------
const tabs=['overview','t1','quiz1','t2','quiz2','final'];
const buttons=[...document.querySelectorAll('nav.tabs .btn')];
function showTab(name){tabs.forEach(t=>document.getElementById('tab-'+t).classList.add('hidden'));document.getElementById('tab-'+name).classList.remove('hidden');buttons.forEach(b=>b.classList.toggle('primary',b.dataset.tab===name));}
buttons.forEach(b=>b.addEventListener('click',()=>showTab(b.dataset.tab)));

// ---------- Stars helper ----------
function stars3(pct){ if(pct>=0.85) return 'â˜…â˜…â˜…'; if(pct>=0.6) return 'â˜…â˜…â˜†'; if(pct>0) return 'â˜…â˜†â˜†'; return 'â˜†â˜†â˜†'; }

// ---------- Total progress ----------
function recomputeTotal(){
  // completion by sections: fc T1, quiz1, fc T2, quiz2, final, overview read
  const s=state.sections;
  const completed = (s.t1.fcDone>=s.t1.fcTotal?1:0) + (s.q1.attempted>=s.q1.total?1:0) + (s.t2.fcDone>=s.t2.fcTotal?1:0) + (s.q2.attempted>=s.q2.total?1:0) + (s.final.attempted>=s.final.total?1:0) + 1; // overview always counted zodra site open is
  const pct = Math.min(100, Math.round((completed/6)*100));
  document.getElementById('totalBar').style.width=pct+'%';
  document.getElementById('totalPct').textContent=pct+'%';
  document.getElementById('stepsDone').textContent=completed;
  // overall accuracy stars = average of available sections
  const parts=[];
  if(s.q1.total>0) parts.push(s.q1.correct/s.q1.total);
  if(s.q2.total>0) parts.push(s.q2.correct/s.q2.total);
  if(s.final.total>0) parts.push(s.final.correct/s.final.total);
  const avg = parts.length? parts.reduce((a,b)=>a+b,0)/parts.length : 0;
  document.getElementById('overallStars').textContent = stars3(avg);
}
recomputeTotal();

document.getElementById('resetProgress').onclick=()=>{ localStorage.removeItem(KEY); location.reload(); };

// ---------- T1 Flashcards ----------
const fc1={q:['Nomadisch','Sedentair','Landbouwrevolutie','Sociale gelaagdheid','Einde prehistorie'],a:['Rondtrekkend leven; geen vaste woonplaats.','Op Ã©Ã©n plek wonen (vaste woonplaats).','Overgang van jagen/verzamelen naar landbouw en veeteelt (ca. 10.000 v.Chr.).','Verschillen in rijkdom en macht tussen groepen.','Rond 3000 v.Chr. door de uitvinding van het schrift.']};
let i1=0; const q1El=document.getElementById('fc1-q'), a1El=document.getElementById('fc1-a'), c1=document.getElementById('fc1-count');
const t1Bar=document.getElementById('t1Bar'), t1Stars=document.getElementById('t1Stars');
function renderFC1(){ q1El.textContent=fc1.q[i1]; a1El.textContent=fc1.a[i1]; c1.textContent=(i1+1)+' / '+fc1.q.length; const pct = Math.round((state.sections.t1.fcDone / state.sections.t1.fcTotal) * 100); t1Bar.style.width=pct+'%'; t1Stars.textContent = stars3(state.sections.t1.fcDone/state.sections.t1.fcTotal); }
renderFC1();
document.getElementById('fc1-show').onclick=()=>{ a1El.style.display = (a1El.style.display==='block'?'none':'block'); };
document.getElementById('fc1-next').onclick=()=>{ if(state.sections.t1.fcDone < state.sections.t1.fcTotal) state.sections.t1.fcDone++; i1 = (i1+1)%fc1.q.length; save(state); renderFC1(); recomputeTotal(); };

// ---------- T2 Flashcards ----------
const fc2={q:['Polis','Democratie (Athene)','Filosofie / wetenschappelijk denken','Romanisering','Pax Romana','PolytheÃ¯sme','MonotheÃ¯sme'],a:['Griekse stadstaat met eigen bestuur en wetten.','Vrije mannen met Atheense ouders beslissen in de volksvergadering.','Met rede en logica verklaringen zoeken (Socrates, Plato, Aristoteles).','Verspreiding/overname van Romeinse taal, cultuur en recht.','Lange periode van vrede en welvaart in het Romeinse rijk.','Geloof in meerdere goden.','Geloof in Ã©Ã©n God.']};
let i2=0; const q2El=document.getElementById('fc2-q'), a2El=document.getElementById('fc2-a'), c2=document.getElementById('fc2-count');
const t2Bar=document.getElementById('t2Bar'), t2Stars=document.getElementById('t2Stars');
function renderFC2(){ q2El.textContent=fc2.q[i2]; a2El.textContent=fc2.a[i2]; c2.textContent=(i2+1)+' / '+fc2.q.length; const pct = Math.round((state.sections.t2.fcDone / state.sections.t2.fcTotal) * 100); t2Bar.style.width=pct+'%'; t2Stars.textContent = stars3(state.sections.t2.fcDone/state.sections.t2.fcTotal); }
renderFC2();
document.getElementById('fc2-show').onclick=()=>{ a2El.style.display = (a2El.style.display==='block'?'none':'block'); };
document.getElementById('fc2-next').onclick=()=>{ if(state.sections.t2.fcDone < state.sections.t2.fcTotal) state.sections.t2.fcDone++; i2 = (i2+1)%fc2.q.length; save(state); renderFC2(); recomputeTotal(); };

// ---------- Question helpers ----------
function renderOpen(container, text){ container.innerHTML=`<div class='flashQ'>${text}</div><input id='ans' class='btn' style='width:100%;margin-top:8px' placeholder='Typ je antwoord in 1 zin'>`; }
function renderMC(container, text, opts){ const buttons = opts.map((o,i)=>`<button class='btn' data-i='${i}' style='display:block;width:100%;margin:6px 0'>${String.fromCharCode(65+i)}. ${o}</button>`).join(''); container.innerHTML=`<div class='flashQ'>${text}</div>${buttons}`; }
function checkOpen(regex){ const v=document.getElementById('ans').value||''; return regex.test(v); }

// ---------- Deeltoets T1 ----------
const q1Bank=[
  {kind:'open', t:'Wat was de landbouwrevolutie?', check:/landbouw|overgang|veeteelt/i, exp:'Overgang van jagen/verzamelen naar landbouw en veeteelt; vaste woonplaatsen en overschotten.'},
  {kind:'mc', t:'Wat betekent â€œsedentairâ€?', opts:['Rondtrekken','Op Ã©Ã©n plek wonen','In tenten wonen','In grotten wonen'], ans:1, exp:'Sedentair = vaste woonplaats.'},
  {kind:'open', t:'Noem Ã©Ã©n gevolg van landbouw.', check:/dorpen|steden|overschot|specialisatie|handel|schrift|bevolking/i, exp:'Overschotten â†’ specialisatie, handel, bevolkingsgroei, dorpen/steden, schrift.'},
  {kind:'mc', t:'Wat markeert het einde van de prehistorie?', opts:['Ontstaan landbouw','Uitvinding schrift','Ontstaan steden','Ontdekking metaal'], ans:1, exp:'Rond 3000 v.Chr. met het schrift.'},
  {kind:'mc', t:'Waarom leefden jagers-verzamelaars in kleine groepen?', opts:['Religie','Meer veiligheid','Makkelijker voedsel vinden','Om handel te drijven'], ans:2, exp:'Kleine groepen konden makkelijker trekken en voedsel vinden.'},
  {kind:'open', t:'Leg â€œnomadischâ€ uit.', check:/rond?trekk|geen vaste/i, exp:'Nomadisch = rondtrekken, geen vaste woonplaats.'}
];
let q1i=0; const q1c=document.getElementById('q1'); const q1fb=document.getElementById('q1-feedback'); const q1prog=document.getElementById('q1-progress'); const q1Bar=document.getElementById('q1Bar'); const q1Stars=document.getElementById('q1Stars');
function renderQ1(){ const q=q1Bank[q1i]; if(q.kind==='open'){renderOpen(q1c,q.t)} else {renderMC(q1c,q.t,q.opts); [...q1c.querySelectorAll('button[data-i]')].forEach(b=>b.onclick=()=>{ q1c.dataset.choice=b.dataset.i; [...q1c.querySelectorAll('button[data-i]')].forEach(x=>x.classList.toggle('primary',x===b)); }); } q1fb.classList.add('hidden'); q1prog.textContent=`Vraag ${q1i+1} / ${q1Bank.length} Â· Goed: ${state.sections.q1.correct}`; q1Bar.style.width=Math.round((state.sections.q1.correct/q1Bank.length)*100)+'%'; q1Stars.textContent=stars3(state.sections.q1.correct/q1Bank.length); }
renderQ1();
document.getElementById('q1-check').onclick=()=>{ const q=q1Bank[q1i]; let ok=false; if(q.kind==='open'){ ok = checkOpen(q.check); } else { ok = Number(q1c.dataset.choice)==q.ans; }
  if(ok) state.sections.q1.correct++; state.sections.q1.attempted++; save(state);
  q1fb.className='feedback '+(ok?'good':'bad'); q1fb.textContent=(ok?'âœ… Goed! ':'âŒ Bijnaâ€¦ ')+q.exp; q1fb.classList.remove('hidden');
  q1prog.textContent=`Vraag ${q1i+1} / ${q1Bank.length} Â· Goed: ${state.sections.q1.correct}`;
  q1Bar.style.width=Math.round((state.sections.q1.correct/q1Bank.length)*100)+'%';
  q1Stars.textContent=stars3(state.sections.q1.correct/q1Bank.length);
  recomputeTotal(); };
document.getElementById('q1-next').onclick=()=>{ if(q1i<q1Bank.length-1){ q1i++; delete q1c.dataset.choice; renderQ1(); } else { q1i=0; renderQ1(); } };

// ---------- Deeltoets T2 ----------
const q2Bank=[
  {kind:'mc', t:'Wie zijn beroemde Griekse filosofen?', opts:['Herodotus, Caesar, Augustus','Socrates, Plato, Aristoteles','Pericles, Spartacus, Jezus','Leonardo, Michelangelo, Raphael'], ans:1, exp:'Socrates, Plato en Aristoteles.'},
  {kind:'open', t:'Wat betekent romanisering?', check:/Romeins|taal|cultuur|recht|verspreiding/i, exp:'Overname/verspreiding van Romeinse taal, cultuur en recht.'},
  {kind:'mc', t:'Wat was de Pax Romana?', opts:['Religieus feest','Periode van vrede en welvaart','Burgeroorlog','Val van het rijk'], ans:1, exp:'Vrede en welvaart bevorderden handel en verspreiding.'},
  {kind:'mc', t:'Wat is een polis?', opts:['Romeinse provincie','Griekse stadstaat','Egyptische tempel','Germaans dorp'], ans:1, exp:'Polis = stadstaat.'},
  {kind:'open', t:'Waarom zagen Romeinen het christendom eerst als bedreiging?', check:/weigerden|keizer|vereren|Ã©Ã©n god|monotheÃ¯sme/i, exp:'Christenen vereerden Ã©Ã©n God en weigerden de keizer te vereren.'},
  {kind:'mc', t:'Wat verspreidde zich via het Romeinse rijk?', opts:['Grieksâ€‘Romeinse cultuur','Islam','Perzische cultuur','Germaanse kunst'], ans:0, exp:'Romanisering = verspreiding Grieksâ€‘Romeinse cultuur.'},
  {kind:'mc', t:'Welke bouwstijl hoort bij de Grieken?', opts:['Gotisch','Barok','Klassiek (zuilen)','Renaissance'], ans:2, exp:'Klassieke vormentaal met zuilen.'},
  {kind:'open', t:'Leg â€œmonotheÃ¯smeâ€ uit.', check:/Ã©Ã©n god|1 god/i, exp:'Geloof in Ã©Ã©n God.'}
];
let q2i=0; const q2c=document.getElementById('q2'); const q2fb=document.getElementById('q2-feedback'); const q2prog=document.getElementById('q2-progress'); const q2Bar=document.getElementById('q2Bar'); const q2Stars=document.getElementById('q2Stars');
function renderQ2(){ const q=q2Bank[q2i]; if(q.kind==='open'){renderOpen(q2c,q.t)} else {renderMC(q2c,q.t,q.opts); [...q2c.querySelectorAll('button[data-i]')].forEach(b=>b.onclick=()=>{ q2c.dataset.choice=b.dataset.i; [...q2c.querySelectorAll('button[data-i]')].forEach(x=>x.classList.toggle('primary',x===b)); }); } q2fb.classList.add('hidden'); q2prog.textContent=`Vraag ${q2i+1} / ${q2Bank.length} Â· Goed: ${state.sections.q2.correct}`; q2Bar.style.width=Math.round((state.sections.q2.correct/q2Bank.length)*100)+'%'; q2Stars.textContent=stars3(state.sections.q2.correct/q2Bank.length); }
renderQ2();
document.getElementById('q2-check').onclick=()=>{ const q=q2Bank[q2i]; let ok=false; if(q.kind==='open'){ ok = checkOpen(q.check); } else { ok = Number(q2c.dataset.choice)==q.ans; }
  if(ok) state.sections.q2.correct++; state.sections.q2.attempted++; save(state);
  q2fb.className='feedback '+(ok?'good':'bad'); q2fb.textContent=(ok?'âœ… Goed! ':'âŒ Bijnaâ€¦ ')+q.exp; q2fb.classList.remove('hidden');
  q2prog.textContent=`Vraag ${q2i+1} / ${q2Bank.length} Â· Goed: ${state.sections.q2.correct}`;
  q2Bar.style.width=Math.round((state.sections.q2.correct/q2Bank.length)*100)+'%';
  q2Stars.textContent=stars3(state.sections.q2.correct/q2Bank.length);
  recomputeTotal(); };
document.getElementById('q2-next').onclick=()=>{ if(q2i<q2Bank.length-1){ q2i++; delete q2c.dataset.choice; renderQ2(); } else { q2i=0; renderQ2(); } };

// ---------- Final ----------
const finalBank=[
  {kind:'mc', t:'Wat markeert het einde van de prehistorie?', opts:['Ontstaan landbouw','Uitvinding schrift','Ontstaan steden','Uitvinding wiel'], ans:1, exp:'Schrift rond 3000 v.Chr.'},
  {kind:'mc', t:'Wat is een polis?', opts:['Griekse stadstaat','Romeins legerkamp','Egyptische tempel','Germaanse stam'], ans:0, exp:'Polis = stadstaat.'},
  {kind:'open', t:'Leg â€œromaniseringâ€ uit.', check:/Romeins|taal|cultuur|recht|overname|verspreiding/i, exp:'Overname/verspreiding van Romeinse cultuur en recht.'},
  {kind:'mc', t:'Waardoor konden steden ontstaan?', opts:['Jacht','Voedseloverschotten','Migratie','Oorlog'], ans:1, exp:'Overschotten uit landbouw.'},
  {kind:'mc', t:'Wie horen bij Griekse filosofie?', opts:['Pericles, Caesar, Augustinus','Socrates, Plato, Aristoteles','Leonardo, Michelangelo, Rafael','Tacitus, Seneca, Nero'], ans:1, exp:'De drie klassieke denkers.'},
  {kind:'open', t:'Wat is het verschil tussen polyâ€‘ en monotheÃ¯sme?', check:/meerder|veel.*goden.*Ã©Ã©n|1.*god/i, exp:'Poly = meerdere goden; mono = Ã©Ã©n God.'},
  {kind:'mc', t:'Wat was de Pax Romana?', opts:['Vrede & welvaart','Burgeroorlog','Val van Rome','Religieuze strijd'], ans:0, exp:'Lange periode van rust â†’ handel en verspreiding.'},
  {kind:'mc', t:'Waarom leefden jagers-verzamelaars nomadisch?', opts:['Om handel te drijven','Ze volgden voedsel en dieren','Religieuze reden','Politiek systeem'], ans:1, exp:'Ze trokken achter voedsel aan.'},
  {kind:'open', t:'Keten: landbouw â†’ ______ â†’ steden (vul het sleutelwoord in).', check:/overschot|voedseloverschot/i, exp:'Landbouw â†’ overschot â†’ specialisatie â†’ steden.'},
  {kind:'mc', t:'Welke factor hielp de verspreiding van het christendom?', opts:['Pax Romana & wegen','Feodalisme','Kruistochten','Vikingen'], ans:0, exp:'Rust en wegen in het rijk.'}
];
let fi=0; const fC=document.getElementById('qfinal'); const fFb=document.getElementById('qfinal-feedback'); const fProg=document.getElementById('qfinal-progress'); const fBar=document.getElementById('finalBar'); const fStars=document.getElementById('finalStars');
function renderFinal(){ const q=finalBank[fi]; if(q.kind==='open'){renderOpen(fC,q.t)} else {renderMC(fC,q.t,q.opts); [...fC.querySelectorAll('button[data-i]')].forEach(b=>b.onclick=()=>{ fC.dataset.choice=b.dataset.i; [...fC.querySelectorAll('button[data-i]')].forEach(x=>x.classList.toggle('primary',x===b)); }); } fFb.classList.add('hidden'); fProg.textContent=`Vraag ${fi+1} / ${finalBank.length} Â· Goed: ${state.sections.final.correct}`; fBar.style.width=Math.round((state.sections.final.correct/finalBank.length)*100)+'%'; fStars.textContent=stars3(state.sections.final.correct/finalBank.length); }
renderFinal();
document.getElementById('qfinal-check').onclick=()=>{ const q=finalBank[fi]; let ok=false; if(q.kind==='open'){ ok = checkOpen(q.check); } else { ok = Number(fC.dataset.choice)==q.ans; }
  if(ok) state.sections.final.correct++; state.sections.final.attempted++; save(state);
  fFb.className='feedback '+(ok?'good':'bad'); fFb.textContent=(ok?'âœ… Goed! ':'âŒ Bijnaâ€¦ ')+q.exp; fFb.classList.remove('hidden');
  fProg.textContent=`Vraag ${fi+1} / ${finalBank.length} Â· Goed: ${state.sections.final.correct}`;
  fBar.style.width=Math.round((state.sections.final.correct/finalBank.length)*100)+'%';
  fStars.textContent=stars3(state.sections.final.correct/finalBank.length);
  recomputeTotal(); };
document.getElementById('qfinal-next').onclick=()=>{ if(fi<finalBank.length-1){ fi++; delete fC.dataset.choice; renderFinal(); } else { fi=0; renderFinal(); } };

// default tab
showTab('overview');
</script>
</body>
</html>
